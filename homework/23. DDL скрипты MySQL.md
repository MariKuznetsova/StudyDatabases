Создание отдельного табличного пространства для таблиц БД
```SQL
CREATE TABLESPACE data_otus ADD DATAFILE 'C:\\MySQL_otusdata\\data_otus.ibd' Engine=InnoDB;
```

Создание ролей
* __admin_pub__ - владелец базы
* __managers_group__ - групповая роль
* __manager1__ и __manager2__ входят в __managers_group__ - пользователи для работы в схеме accounting
* __editor__ - пользователь для работы в схеме catalog

```SQL
CREATE ROLE admin_pub with login createdb createrole;
CREATE ROLE managers_group;
CREATE USER manager1;
CREATE USER manager2;
CREATE USER editor;
GRANT managers_group to manager1;
GRANT managers_group to manager2;
```

Создание базы данных
```SQL
CREATE DATABASE IF NOT EXISTS publishing;
```

Создание таблиц и добавление ограничений
```SQL
CREATE TABLE if not exists Publisher (
        PublisherID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        PublisherName VARCHAR (1000) NOT NULL);

CREATE TABLE if not exists PublisherSeries (
        PublisherSeriesID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        PublisherSeriesName VARCHAR (1000) NOT NULL UNIQUE); -- название издательской серии уникально

CREATE TABLE if not exists Form (
        FormID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        FormName VARCHAR (100) NOT NULL);

CREATE TABLE if not exists Language (
        LanguageID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        LanguageName VARCHAR (100));

CREATE TABLE if not exists Country (
        CountryID CHAR (3) PRIMARY KEY CHECK (length(CountryID) = 3), --буквенный код страны должен составлять 3 символа.
        CountryName VARCHAR (100) NOT NULL);

CREATE TABLE if not exists WorkSeries (
        WorkSeriesID MEDIUMINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        WorkSeriesName VARCHAR (1000) NOT NULL,
        TotalNumber SMALLINT UNSIGNED NOT NULL CHECK (TotalNumber != 0));  --количество произведений в серии должно быть > 0

CREATE TABLE if not exists Work (
        WorkID INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        Name VARCHAR (1000) NOT NULL,
        LanguageID TINYINT UNSIGNED NOT NULL,
        FormID TINYINT UNSIGNED NOT NULL,
        Year SMALLINT UNSIGNED CHECK (Year != 0),
        WorkSeriesID MEDIUMINT UNSIGNED NOT NULL,
        -- номер в серии должен быть > 0 или NULL для произведений, которые не входят в серию
        SerialNumber SMALLINT UNSIGNED CHECK (SerialNumber > 0), 
        Translation BOOLEAN NOT NULL,
        OriginalWorkID INT UNSIGNED,
        SourceLanguageID TINYINT UNSIGNED,
        TranslationYear SMALLINT UNSIGNED CHECK (TranslationYear != 0),
        FOREIGN KEY (LanguageID) REFERENCES Language (LanguageID) ON DELETE NO ACTION,
        FOREIGN KEY (FormID) REFERENCES Form (FormID) ON DELETE NO ACTION,
        FOREIGN KEY (WorkSeriesID) REFERENCES WorkSeries (WorkSeriesID) ON DELETE NO ACTION,
        FOREIGN KEY (OriginalWorkID) REFERENCES Work (WorkID) ON DELETE NO ACTION,
        FOREIGN KEY (SourceLanguageID) REFERENCES Language (LanguageID) ON DELETE NO ACTION);

CREATE TABLE if not exists Book (
        ISBN CHAR(17) PRIMARY KEY CHECK (length(ISBN) = 17), -- длина первичного ключа (код ISBN) должна быть ровно 17 символов
        BBK VARCHAR (50) NOT NULL,
        UDK VARCHAR (50) NOT NULL,
        BookTitle VARCHAR (1000) NOT NULL,
        PublisherID TINYINT UNSIGNED NOT NULL,
        PublisherSeriesID TINYINT UNSIGNED NOT NULL,
        PublishYear SMALLINT UNSIGNED NOT NULL CHECK (PublishYear != 0),
        Cover ENUM ('Мягкая обложка', 'Твердая обложка', 'Суперобложка') NOT NULL DEFAULT 0,
        PageCounts TINYINT UNSIGNED NOT NULL CHECK (PageCounts != 0), -- количество страниц в книге должно быть > 0
        Illustrations BOOLEAN NOT NULL,
        Size ENUM ('84x108 1/32', '76x100 1/32', '60x90 1/16', '70x100 1/16') NOT NULL DEFAULT 0,
        AgeLimit ENUM ('0+', '6+', '12+', '16+', '18+') NOT NULL DEFAULT 0,
        Weight SMALLINT UNSIGNED NOT NULL CHECK (Weight != 0), -- вес книги должен быть больше 0
        Status ENUM ('в работе', 'готовится к печати', 'печать', 'есть на складе', 'нет в продаже') NOT NULL DEFAULT 0,
        FOREIGN KEY (PublisherID) REFERENCES Publisher (PublisherID) ON DELETE NO ACTION,
        FOREIGN KEY (PublisherSeriesID) REFERENCES PublisherSeries (PublisherSeriesID) ON DELETE NO ACTION);

CREATE TABLE if not exists BookWork (
        ISBN CHAR (17),
        WorkID INT UNSIGNED NOT NULL,
        PRIMARY KEY (ISBN, WorkID),
        FOREIGN KEY (ISBN) REFERENCES Book (ISBN) ON DELETE NO ACTION,
        FOREIGN KEY (WorkID) REFERENCES Work (WorkID) ON DELETE NO ACTION);

CREATE TABLE if not exists Author (
        AuthorID MEDIUMINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        AuthorName VARCHAR (1000) NOT NULL,
        AuthorLastName VARCHAR (1000) NOT NULL,
        AuthorMiddleName VARCHAR (1000),
        CountryID CHAR (3),
        FOREIGN KEY (CountryID) REFERENCES Country (CountryID) ON DELETE NO ACTION);

CREATE TABLE if not exists AuthorWork (
        AuthorID MEDIUMINT UNSIGNED NOT NULL,
        WorkID INT UNSIGNED NOT NULL,
        Role ENUM ('Автор', 'Переводчик') NOT NULL DEFAULT 0,
        PRIMARY KEY (AuthorID, WorkID),
        FOREIGN KEY (AuthorID) REFERENCES Author (AuthorID) ON DELETE NO ACTION,
        FOREIGN KEY (WorkID) REFERENCES Work (WorkID) ON DELETE NO ACTION);

CREATE TABLE if not exists AuthorTranslation (
        AuthorID MEDIUMINT UNSIGNED NOT NULL,
        LanguageID TINYINT UNSIGNED NOT NULL,
        AuthorName VARCHAR (1000) NOT NULL,
        AuthorLastName VARCHAR (1000) NOT NULL,
        AuthorMiddleName VARCHAR (1000),
        PRIMARY KEY (AuthorID, LanguageID),
        FOREIGN KEY (AuthorID) REFERENCES Author (AuthorID) ON DELETE NO ACTION,
        FOREIGN KEY (LanguageID) REFERENCES Language (LanguageID) ON DELETE NO ACTION);

CREATE TABLE if not exists Specialist (
        SpecialistID MEDIUMINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        SpecialistName VARCHAR (1000) NOT NULL,
        SpecialistLastName VARCHAR (1000) NOT NULL,
        SpecialistMiddleName VARCHAR (1000),
        Position ENUM ('Младший редактор', 'Выпускающий редактор', 'Редактор', 'Ведущий редактор', 'Корректор', 'Младший дизайнер', 'Дизайнер', 'Художник') NOT NULL DEFAULT 0);

CREATE TABLE if not exists SpecialistBook (
        SpecialistID MEDIUMINT UNSIGNED NOT NULL,
        ISBN CHAR (17),
        Role ENUM ('Иллюстрации для обложки','Иллюстрации внутри книги','Дизайн обложки','Серийное оформление','Художественное оформление','Художественный редактор','Ведущий редактор','Ответственный редактор','Редактор','Технический редактор','Младший редактор','Приглашенный редактор','Компьютерная верстка','Корректор') NOT NULL DEFAULT 0,
        PRIMARY KEY (SpecialistID, ISBN, Role),
        FOREIGN KEY (SpecialistID) REFERENCES Specialist (SpecialistID) ON DELETE NO ACTION,
        FOREIGN KEY (ISBN) REFERENCES Book (ISBN) ON DELETE NO ACTION);

CREATE TABLE if not exists PrintingOffice (
        PrintingOfficeID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        Name VARCHAR (1000) NOT NULL,
        Address VARCHAR (1000) NOT NULL,
        Phone VARCHAR (50) NOT NULL,
        Email VARCHAR (100) NOT NULL);

CREATE TABLE if not exists PrintOrder (
        PrintOrderID VARCHAR (50),
        PrintingOfficeID TINYINT UNSIGNED NOT NULL,
        ISBN CHAR (17) NOT NULL,
        Date DATE NOT NULL,
        Typeface ENUM ('GaramondC', 'Literaturnaya', 'Newton') NOT NULL DEFAULT 0,
        Print ENUM ('Офсетная', 'Трафаретная', 'Цифровая', 'Лазерная') NOT NULL DEFAULT 0,
        SheetCount NUMERIC (5,2) UNSIGNED NOT NULL CHECK (SheetCount != 0), -- количество условных печатных листов > 0
        PaperType ENUM ('Офсетная', 'Мелованная', 'Газетная') NOT NULL DEFAULT 0,
        Printing ENUM ('Основной', 'Дополнительный') NOT NULL DEFAULT 0,
        СopiesCount MEDIUMINT UNSIGNED NOT NULL CHECK (СopiesCount != 0), -- тираж должен быть > 0
        TotalPrice NUMERIC (12,4) UNSIGNED NOT NULL CHECK (TotalPrice != 0), -- стоимость печати должна быть > 0
        PRIMARY KEY (PrintOrderID, PrintingOfficeID),
        FOREIGN KEY (PrintingOfficeID) REFERENCES PrintingOffice (PrintingOfficeID) ON DELETE NO ACTION,
        FOREIGN KEY (ISBN) REFERENCES Book (ISBN) ON DELETE NO ACTION);

CREATE TABLE if not exists Customer (
        CustomerID INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        CustomerName VARCHAR (1000) NOT NULL,
        Address VARCHAR (1000) NOT NULL,
        Phone VARCHAR (50) NOT NULL,
        Email VARCHAR (100) NOT NULL);

CREATE TABLE if not exists Order (
        OrderID INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        OrderDate TIMESTAMP NOT NULL,
        TotalPrice NUMERIC (14,4) UNSIGNED NOT NULL CHECK(TotalPrice != 0), -- стоимость заказа должна быть > 0
        Status ENUM ('Создан', 'Оплачен', 'Комплектация', 'Доставка', 'Завершен') NOT NULL DEFAULT 0,
        CustomerID INT UNSIGNED NOT NULL,
        TotalCount MEDIUMINT UNSIGNED NOT NULL CHECK(TotalCount != 0), -- общее количество книг в заказе > 0
        TotalWeight INT UNSIGNED NOT NULL CHECK(TotalWeight != 0), -- общий вес должен быть > 0
        FOREIGN KEY (CustomerID) REFERENCES Customer (CustomerID) ON DELETE NO ACTION);

CREATE TABLE if not exists BookOrder (
        ISBN CHAR (17),
        OrderID INT UNSIGNED NOT NULL,
        BookPrice NUMERIC (10,4) UNSIGNED NOT NULL CHECK (BookPrice != 0), -- цена 1 книги должна быть > 0
        Count MEDIUMINT UNSIGNED NOT NULL CHECK (Count != 0), -- количество конкретной книги в заказе > 0
        PRIMARY KEY (ISBN, OrderID),
        FOREIGN KEY (ISBN) REFERENCES Book (ISBN) ON DELETE NO ACTION,
        FOREIGN KEY (OrderID) REFERENCES Order (OrderID) ON DELETE NO ACTION);
```

Создание индексов
```SQL
-- В схеме catalog наиболее частый поиск предполагается по полям название книги, фамилия и имя автора (на русском языке),
-- название произведения. Это поля с высокой кардинальностью.
CREATE INDEX if not exists Book_BookTitle_idx ON Book (BookTitle);
CREATE INDEX if not exists Author_LastName_idx ON Author (AuthorLastName);
CREATE INDEX if not exists Author_Name_idx ON Author (AuthorName);
CREATE INDEX if not exists Work_Name_idx ON Work (Name);
-- Также частыми будут запросы с использованием поля Status книги (в работе/готовится к печати/печать/есть на складе/нет в продаже).
-- Хотя кардинальность поля низкая, имеет смысл создать индекс и на него.
CREATE INDEX if not exists Book_Status_idx ON Book (Status);
-- В схеме accounting можно запланировать индексы на Название организации-заказчика. Какие заказы делала конкретная организация.
-- на Статус заказа - какие заказы и от каких организация, например, ожидают оплаты
-- на Дату заказа - какие заказы были сделаны, например, за последние полгода
CREATE INDEX if not exists Customer_CustomerName_idx ON Customer (CustomerName);
CREATE INDEX if not exists Order_Status_idx ON Order (Status);
CREATE INDEX if not exists Order_OrderDate_idx ON Order (OrderDate);
-- В целом в базе не ожидается очень большого объема данных и массовых Insert или Update, поэтому индексы не должны помешать производительности. 
```

Распределение прав для работы в схемах
```SQL
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA catalog TO "editor";
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA accounting TO "managers_group";
```